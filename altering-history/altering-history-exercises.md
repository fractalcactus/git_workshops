# Altering History

See Atlassian's excellent blog on [rewriting history]( https://www.atlassian.com/git/tutorials/rewriting-history).

Before doing these exercises, make sure that your Git editor is set to the editor of your choice. e.g:

`git config --global core.editor "vim" # set vim as the Git editor`

`git config --global core.editor "code --wait" set visual studio as the Git editor`

`git config --global core.editor "subl -n -w" # set sublime as the Git editor`

## Exercises

### 1. Alter the most recent commit's message
change the most recent commit message from "feat: run npm i" to "feat: run npm init"

### 2. Alter the most recent commit's files
- `git log` to see the logs. So far, so good. Note down the hash of the latest commit somewhere.
- inspect the changes introduced by the last commit with `git show` (`show` defaults to HEAD, but you can `show` any commit by passing the hash)
- bother, I accidently added an autogenerated `.DS_Store` file in that commit

remove `.DS_Store` from the previous commit, without altering the commit message.

### 3. Alter any commit message
change the second commit message from "feat: add fitignore" to "feat: add gitignore"

### 4. Merge commits together
Merge all the work in the last three commits into one commit, with the message "feat: add a styled homepage"



## Answers
Here are the solutions I came up with, but there's more than one way to shear a llama...

1. `git commit --amend -m "feat: run npm init"`
1. manually delete `diary.txt`, or run `rm diary.txt`

    ```
    git add diary.txt # The command 'add' can seem confusing here! This adds the CHANGE, i.e the removal of a file.
    git commit --amend --no-edit
    git show # note that the hash has changed, as the files in the commit changed
    ```
1. `git rebase -i HEAD~3`:


   use the `r` a.k.a `reword` command before the commit you want to reword. Note that this is  not the stage where you can reword the message, you will make edits to the message in the next step. Any changes you make to the commit message here will disappear.
   
   
    <img width="764" alt="image" src="https://user-images.githubusercontent.com/8527715/110055810-8ac18d80-7dc2-11eb-9ecf-05f86b9004ac.png">
   
   
   save and quit this screen, and the next step will pop up

    <img width="827" alt="image" src="https://user-images.githubusercontent.com/8527715/110055909-b80e3b80-7dc2-11eb-8f87-14e4c1ee5bf5.png">

    make the changes to your commit message, save and quit again

    git should output something along the lines of this to your terminal: `[detached HEAD eb1d071] feat: add gitignore`

    check out the logs to see that you successfully updated that commit message



1. `git rebase -i HEAD~3`
    
    
  ## Notes for the real world
- Be aware that if you've rewritten history that is already on the internet e.g github/bitbucket, when you push you'll need to use `--force` If others are working on a copy of the branch then you might create some chaos :slightly_smiling_face:
- The heuristic I go by is to only alter history that I have access to, e.g a feature branch in PR, or a local branch. Any other history alterations should include chatting with your coworkers about how to manage the process.

